# NULS2.0 API

**NULSCustomized docking requirements for partnersNULS2.0Wallet version, compatible with embedded wallet`NULS-API`Module, encapsulated within the moduleNULS-SDKThe function of usingHTTPProtocol access interface, supporting`JSON—RPC`and`Restful`Two formats.**

[Download address for main website or test version wallet](https://github.com/nuls-io/nuls-v2/releases)

[NULS-APIOffline operation tool download address](http://nuls-cn.oss-cn-hangzhou.aliyuncs.com/2.1/NULS_API-offline_v2.0.0.tar.gz)

## set up

​	`NULS-API`The default port number accessed by the module is18004, can be found in thenuls.ncfMake modifications to the configuration file as follows：

```
[nuls-API]
#httpServerStart ofport
serverPort=18004
```

## explain

​	For a better understandingNULS2.0Please provide some explanations in advance regarding the relevant business and the meaning of interface return values.

### Online and offline

`NULS-API`The module provides several online and offline interfaces.

Online interface：The wallet must be running normally and able to connect to other nodes in the network, synchronize blocks and broadcast data normally. It is best to synchronize to the latest block before calling the online interface. The data generated by the interface will be saved in the wallet. For example, creating an account、Change password、Transfer、Obtain block headers, etc.

Offline interface：NULS2.0Provided a dedicated tool for[Offline operationNULS-APItool](http://nuls-cn.oss-cn-hangzhou.aliyuncs.com/2.1/NULS_API-offline_v2.0.0.tar.gz). No need to install a wallet, it can run independently on a server without a network connection. The user calls the offline interface, passes in relevant parameters, obtains the return value, and the corresponding data is not stored in the wallet. For example, creating an account offline、Offline assembly transfer transaction、Offline signature, etc.

### Field Description

**Chain basedchainId:**

​	NULS2.0Support multi chain parallel and cross chain transfer, with each chain passing through the chainIDTo distinguish,NULSChain of the main networkIDby1,NULSChain of testing networkIDby2.

**Chain assets：**

​	NULS2.0Support each chain to dynamically add assets according to business needs, in addition to default assets. Each asset in each chain passes through the chainIDAnd assetsIDDistinguish by using a composite primary key. for exampleNULSMain networkNULS,chainId=1,assetId=1

**Transactionaltypevalue：**

​	NULS2.0There are multiple transactions by default, each with different functions. When calling the interface to query transaction details, you can use thetypeFields are used to distinguish different transaction types. The following are the enumeration values for transaction types：

```
int COIN_BASE = 1;						// coinBaseReward for block output
int TRANSFER = 2;						// Transfer
int ACCOUNT_ALIAS = 3;					// Set account alias
int REGISTER_AGENT = 4;					// Create a new consensus node
int DEPOSIT = 5;						// Entrusting participation in consensus
int CANCEL_DEPOSIT = 6;					// Cancel delegation consensus
int YELLOW_PUNISH = 7;					// Yellow card
int RED_PUNISH = 8;						// Red card
int STOP_AGENT = 9;						// Unregister consensus node
int CROSS_CHAIN = 10;					// Cross chain transfer
int REGISTER_CHAIN_AND_ASSET = 11;		// Registration Chain
int DESTROY_CHAIN_AND_ASSET = 12;		// Unregister Chain
int ADD_ASSET_TO_CHAIN = 13;			// Add an asset to the chain
int REMOVE_ASSET_FROM_CHAIN = 14;		// Delete on chain assets
int CREATE_CONTRACT = 15;				// Create a smart contract
int CALL_CONTRACT = 16;					// Calling smart contracts
int DELETE_CONTRACT = 17;				// Delete smart contract
int CONTRACT_TRANSFER = 18;				// Internal transfer of contract
int CONTRACT_RETURN_GAS = 19;			// Contract execution fee refund
int CONTRACT_CREATE_AGENT = 20;			// Contract New Consensus Node
int CONTRACT_DEPOSIT = 21;				// Contract Entrustment Participation Consensus
int CONTRACT_CANCEL_DEPOSIT = 22;		// Contract cancellation commission consensus
int CONTRACT_STOP_AGENT = 23;			// Contract Cancellation Consensus Node
int VERIFIER_CHANGE = 24;				// Verifier change
int VERIFIER_INIT = 25;                 //Verifier initialization
```

**Transactionalfromandto：**

Taking transfer transactions as an example：tx.type = 2

​	fromFor the transferor of the transfer transaction, eachfromHow many assets are considered to be transferred out by a transferor, wherenonceThe value will change after each transfer, and the latest information can be obtained by calling the account balance query interfacenonceValue.

​	toFor the recipient of the transfer transaction, eachtoHow much quantity of a certain asset is considered received by the receiver, wherelockTimeLock the time. When the lock time is greater than0When the actual time exceeds this value, it means that this asset can only be used normally；WhenlockTime =-1When, it indicates that in a permanent lock, special transactions are required to unlock, such as participating in entrusted consensus and canceling entrusted consensus.

​	Transaction fees = fromThe sum of the main assets of the Li Ben Chain - toThe sum of the main assets of the Li Ben Chain


## Access method

- **`JSON-RPC`Access method**

     Add request header Content-Type: application/json;charset=UTF-8
     
     HttpMethod: POST
     
     URL: http://${ip}:${port}/jsonrpc 
     
        Example: http://127.0.0.1:18004/jsonrpc
     
     Request data format: 
     
     ```json
     {
       "jsonrpc":"2.0",
       "method":"methodCMD", //Interface Name
       "params":[],          //All interface parameters are passed in an array format and the order of parameters cannot be changed. If the parameters are not mandatory, they must also be filled innullseize a seat
       "id":1234
     }
     ```

- **`RESTFUL`Access method**

     Add request header Content-Type: application/json;charset=UTF-8
     
     Please refer to the rest [RESTFUL Interface documentation](https://github.com/nuls-io/nuls-v2/blob/master/module/nuls-api/documents/nuls-api_RESTFUL.md)


## Interface documentation

What we provide to the outside worldAPIInterface, divided into`JSON-RPC`and`Restful`There are two styles, and users can choose the docking method that does not pass according to their needs. The interface documentation is detailed below: 

[JSON-RPC Interface documentation](https://github.com/nuls-io/nuls-v2/blob/master/module/nuls-api/documents/nuls-api_JSONRPC.md)

[RESTFUL Interface documentation](https://github.com/nuls-io/nuls-v2/blob/master/module/nuls-api/documents/nuls-api_RESTFUL.md)

_**attach：**_ Officially providedNULS-SDK-4JTools, available for useJAVACollaborating partners who can use tools to connect`NULS-API`Module, see details：[NULS-SDK-4JInstructions for use](https://github.com/nuls-io/nuls-v2-sdk4j/blob/master/README.md)

## Interface debugging

We provide`Postman`Import files for interface debugging tools(`JSON-RPC`and`RESTFUL`)After importing, you can debug the interface

[JSON-PRC Interface debugging-POSTMANImport file](https://github.com/nuls-io/nuls-v2/blob/master/module/nuls-api/documents/nuls-api_Postman_JSONRPC.json)

[RESTFUL Interface debugging-POSTMANImport file](https://github.com/nuls-io/nuls-v2/blob/master/module/nuls-api/documents/nuls-api_Postman_RESTFUL.json)


